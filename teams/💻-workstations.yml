agent_options:
  config:
    decorators:
      load:
      - SELECT uuid AS host_uuid FROM system_info;
      - SELECT hostname AS hostname FROM system_info;
    options:
      disable_distributed: false
      distributed_interval: 10
      distributed_plugin: tls
      distributed_tls_max_attempts: 3
      logger_tls_endpoint: /api/osquery/log
      logger_tls_period: 10
      pack_delimiter: /
  overrides:
controls:
  enable_disk_encryption: true
  ios_updates:
    deadline:
    minimum_version:
  ipados_updates:
    deadline:
    minimum_version:
  macos_setup: 'TODO: update with your macos_setup configuration'
  macos_updates:
    deadline:
    minimum_version:
  scripts:
  - path: "../lib/ðŸ’»-workstations/scripts/uninstall-fleetd-linux.sh"
  - path: "../lib/ðŸ’»-workstations/scripts/uninstall-fleetd-macos.sh"
  - path: "../lib/ðŸ’»-workstations/scripts/uninstall-fleetd-windows.ps1"
  windows_enabled_and_configured: true
  windows_require_bitlocker_pin: false
  windows_updates:
    deadline_days:
    grace_period_days:
name: "ðŸ’» Workstations"
policies:
- calendar_events_enabled: false
  conditional_access_enabled: false
  critical: false
  description: Looks for PDF files with file names typically used by 1Password for
    emergency recovery kits. To protect the performance of your devices, the search
    is one level deep and limited to the Desktop, Documents, Downloads, and Shared
    folders.
  name: macOS - No 1Password emergency kit stored in desktop, documents, or downloads
    folders
  platform: darwin
  query: SELECT 1 WHERE NOT EXISTS ( SELECT 1 FROM file WHERE filename LIKE '%Emergency
    Kit%.pdf' AND (path LIKE '/Users/%/Desktop/%' OR path LIKE '/Users/%/Documents/%'
    OR path LIKE '/Users/%/Downloads/%' OR path LIKE '/Users/Shared/%') );
  resolution: Delete 1Password emergency kits from your computer, and empty the trash.
    1Password emergency kits should only be printed and stored in a physically secure
    location.
- calendar_events_enabled: false
  conditional_access_enabled: false
  critical: false
  description: This Mac may have outdated system software, which could lead to security
    vulnerabilities, performance issues, and incompatibility with other systems.
  name: macOS - All available software updates installed
  platform: darwin
  query: SELECT 1 FROM software_update WHERE software_update_required = 0;
  resolution: Please take some time and run all available updates from Software Update
    (ï£¿ > System Settings > Software Update) and all available app store updates (ï£¿
    > App Store > Updates).
- calendar_events_enabled: false
  conditional_access_enabled: false
  critical: false
  description: This Windows device may have outdated system software, which could
    lead to security vulnerabilities, performance issues, and incompatibility with
    other systems.
  name: Windows - All available updates installed
  platform: windows
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM windows_updates);
  resolution: Run all available Windows updates.
- calendar_events_enabled: false
  conditional_access_enabled: false
  critical: false
  description: Checks the status of antivirus and signature updates from the Windows
    Security Center.
  name: Windows - Antivirus signatures up to date
  platform: windows
  query: SELECT 1 FROM windows_security_products WHERE name LIKE '%Microsoft Defender
    Antivirus%' AND signatures_up_to_date = 1;
  resolution: Run all available Windows updates.
- calendar_events_enabled: false
  conditional_access_enabled: false
  critical: false
  description: This policy checks if disk encryption is enabled.
  name: Linux - Disk encryption enabled
  platform: linux
  query: SELECT 1 FROM mounts m, disk_encryption d WHERE m.device_alias = d.name AND
    d.encrypted = 1 AND m.path = '/';
  resolution: Disk encryption can only be configured during initial operating system
    install. Please re-install your operating system ensuring disk encryption is enabled.
queries:
software:
  packages:
  - categories:
    - Productivity
    hash_sha256: c228bdf3708ea280425f2895d9ad8c0bb48a9c524ba7525ab21b0ecd3dfe6510
      # 1Password (1Password-8.11.8-aarch64.zip) version 8.11.8
    install_script:
      path: "../lib/ðŸ’»-workstations/scripts/1password-darwin-install"
    setup_experience: true
    uninstall_script:
      path: "../lib/ðŸ’»-workstations/scripts/1password-darwin-uninstall"
    url: https://downloads.1password.com/mac/1Password-8.11.8-aarch64.zip
  - hash_sha256: ee16cb40bd412c7a56413961b9ca787cda39546d31e70f63544b4a69a79ddcc2
      # Tailscale (Tailscale-1.74.0-macos.pkg) version 1.74.0
    install_script:
      path: "../lib/ðŸ’»-workstations/scripts/tailscale-darwin-install"
    setup_experience: true
    uninstall_script:
      path: "../lib/ðŸ’»-workstations/scripts/tailscale-darwin-uninstall"
team_settings:
  features:
    enable_host_users: true
    enable_software_inventory: true
  host_expiry_settings:
    host_expiry_enabled: false
    host_expiry_window: 0
  integrations:
    conditional_access_enabled:
    google_calendar:
  secrets:
  - secret: "$FLEET_WORKSTATIONS_ENROLL_SECRET"
  webhook_settings:
    failing_policies_webhook:
      destination_url:
      enable_failing_policies_webhook: false
      host_batch_size: 0
      policy_ids:
    host_status_webhook: